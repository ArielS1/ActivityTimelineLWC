<template>
    <div class="slds-card">
        <div if:true={showHeader} class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <lightning-icon icon-name={headerIcon} class="slds-m-around_xx-small"></lightning-icon>
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title">
                        <a href="#" class="slds-card__header-link slds-truncate" title={headerTitle}>
                            <span>{headerTitle}</span>
                        </a>
                    </h2>
                </div>
                <div class="slds-no-flex slds-float_right slds-is-relative">
                    <a class="slds-button" role="button" onclick={showHideFilters}>
                        <lightning-button-icon icon-name="utility:filterList" alternative-text="Filter" size="x-small">
                        </lightning-button-icon>
                    </a>
                    <a class="slds-button" role="button" onclick={refreshData}>
                        <lightning-button-icon icon-name="action:refresh" alternative-text="Refresh data" size="x-small">
                        </lightning-button-icon>
                    </a>
                    <div class="filterPopover" style={filterStyles}>
                        <section aria-label="Filter results" aria-describedby="filter-body-id"
                            class="slds-popover slds-nubbin_top-right" role="dialog">
                            <div id="filter-body-id" class="slds-popover__body">
                                <lightning-radio-group name="dateFilterCriteria" label="Date Range" onchange={handleDateFilterChange} options={dateFilterOptions} value={dateFilterSelection} type="radio">
                                </lightning-radio-group>
                            </div>
                        </section>
                    </div>
                </div>
            </header>
        </div>
        <article if:true={isParametersValid}>
        <ul if:false={error} class="slds-timeline slds-m-around_small">
            <li if:false={showHeader} class="slds-timeline__actions slds-timeline__actions_inline slds-is-relative">
                <div class="slds-no-flex slds-float_right slds-is-relative">
                    <a class="slds-button" role="button" onclick={showHideFilters}>
                        <lightning-button-icon icon-name="utility:filterList" alternative-text="Filter" size="x-small">
                        </lightning-button-icon>
                    </a>
                    <a class="slds-button" role="button" onclick={refreshData}>
                        <lightning-button-icon icon-name="action:refresh" alternative-text="Refresh data" size="x-small">
                        </lightning-button-icon>
                    </a>
                    <div class="filterPopover" style={filterStyles}>
                        <section aria-label="Filter results" aria-describedby="filter-body-id_2"
                            class="slds-popover slds-nubbin_top-right" role="dialog">
                            <div id="filter-body-id_2" class="slds-popover__body">
                                <lightning-radio-group name="dateFilterCriteria" label="Date Range" onchange={handleDateFilterChange} options={dateFilterOptions} value={dateFilterSelection} type="radio">
                                </lightning-radio-group>
                            </div>
                        </section>
                    </div>
    
                </div>
            </li>
            <template for:each={childRecords} for:item="theRecord">
                <c-timeline-item if:false={theRecord.isUiApiNotSupported} key={theRecord.recordId} object={theRecord.object}
                    title={theRecord.title} date-value={theRecord.dateValue}
                    expanded-fields-to-display={theRecord.expandedFieldsToDisplay} record-id={theRecord.recordId}
                    theme-info={theRecord.themeInfo}>
                </c-timeline-item>
                <c-timeline-item-other-object if:true={theRecord.isUiApiNotSupported} key={theRecord.recordId} object={theRecord.object}
                    title={theRecord.title} date-value={theRecord.dateValue}
                    expanded-fields-to-display={theRecord.expandedFieldsToDisplay} record-id={theRecord.recordId}
                    theme-info={theRecord.themeInfo}>
                </c-timeline-item-other-object>
                <c-timeline-item-task if:true={theRecord.isTask} key={theRecord.recordId} title={theRecord.title}
                    date-value={theRecord.dateValue} record-id={theRecord.recordId} description={theRecord.description}
                    who-to-name={theRecord.whoToName} owner-id={theRecord.OwnerId}
                    assigned-to-name={theRecord.assignedToName} who-id={theRecord.WhoId}
                    task-subtype={theRecord.TaskSubtype}>

                </c-timeline-item-task>
            </template>
        </ul>
        <div if:true={error} class="slds-text-color_destructive">
            {errorMsg}
        </div>
    </article>
<div if:false={isParametersValid} class="slds-text-color_destructive">
        Invalid configuration parameters. Either recordId or configId are empty.
    </div>
</div>

</template>