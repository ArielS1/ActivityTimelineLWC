<template>
    <div class="slds-card">
        <div if:true={showHeader} class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <lightning-icon icon-name={headerIcon} class="slds-m-around_xx-small"></lightning-icon>
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title">
                        <a href="#" class="slds-card__header-link slds-truncate" title={headerTitle}>
                            <span>{headerTitle}</span>
                        </a>
                    </h2>
                </div>
                <c-timeline-filter-panel object-filters={filteredObjects} available-objects={availableObjects} onchange={handleFilterChange}></c-timeline-filter-panel>
            </header>
        </div>
        <article if:true={isParametersValid}>
        <ul if:false={error} class="slds-timeline slds-m-around_small">
            <li if:false={showHeader} class="slds-timeline__actions slds-timeline__actions_inline slds-is-relative">
                <c-timeline-filter-panel object-filters={filteredObjects} available-objects={availableObjects} onchange={handleFilterChange}></c-timeline-filter-panel>
            </li>
            <template for:each={childRecords} for:item="theRecord">
                <c-timeline-item if:false={theRecord.isUiApiNotSupported} key={theRecord.recordId} object={theRecord.object}
                    title={theRecord.title} date-value={theRecord.dateValue}
                    expanded-fields-to-display={theRecord.expandedFieldsToDisplay} record-id={theRecord.recordId}
                    theme-info={theRecord.themeInfo}>
                </c-timeline-item>
                <c-timeline-item-other-object if:true={theRecord.isUiApiNotSupported} key={theRecord.recordId} object={theRecord.object}
                    title={theRecord.title} date-value={theRecord.dateValue}
                    expanded-fields-to-display={theRecord.expandedFieldsToDisplay} record-id={theRecord.recordId}
                    theme-info={theRecord.themeInfo}>
                </c-timeline-item-other-object>
                <c-timeline-item-task if:true={theRecord.isTask} key={theRecord.recordId} title={theRecord.title}
                    date-value={theRecord.dateValue} record-id={theRecord.recordId} description={theRecord.description}
                    who-to-name={theRecord.whoToName} owner-id={theRecord.OwnerId}
                    assigned-to-name={theRecord.assignedToName} who-id={theRecord.WhoId}
                    task-subtype={theRecord.TaskSubtype}>

                </c-timeline-item-task>
            </template>
        </ul>
        <div if:true={error} class="slds-text-color_destructive">
            {errorMsg}
        </div>
    </article>
<div if:false={isParametersValid} class="slds-text-color_destructive">
        Invalid configuration parameters. Either recordId or configId are empty.
    </div>
</div>

</template>